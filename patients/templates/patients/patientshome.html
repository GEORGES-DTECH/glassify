

{%extends 'base.html'%}

{%block content%}

    <button class="btn-primary btn-sm" onclick="exportDataToExcel('patientTable')" style="margin-bottom: 2;">Export  patients details to excel</button>
    <table id="patientTable" class="table table-bordered table-dark ">
        <thead>
            <tr>
                <th scope="col" style="color: gold;">No</th>
                <th scope="col" style="color: gold;">Date</th>>
                <th scope="col" style="color: gold;">Patients name</th>>
                <th scope="col" style="color: gold;">phone number</th>
                <th scope="col" style="color: gold;">Age</th>
                <th scope="col" style="color: gold;">Right eye</th>
                <th scope="col" style="color: gold;">Left eye</th>
                <th scope="col" style="color: gold;">Frame</th>
                <th scope="col" style="color: gold;">Lenses</th>
                <th scope="col" style="color: gold;">Employee</th>
            </tr>
        </thead>
    
        <tbody>
            <tr>
        {%for patient in patients.all%}
                <th scope="row">{{patient.id}}</th>
                
                
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.Date}}</a></td>
       

               <b> <td ><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.patients_name}}</a></td></b>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.patients_mobile}}</a></td>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.patients_age}}</a></td>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.Right_eye}}</a></td>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.Left_eye}}</td></a>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.frame}}</td></a>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.lenses}}</a></td>
                <td><a href="{%url 'patient_details' patient.id%} " style="color:white;">{{patient.author}}</a></td>
                </a>
            </tr>



        {%endfor%}

 
  
  <script type="text/javascript">
  
  function exportDataToExcel(tableId ,filename="Patient Details"){
      var downloadLink;
      var dataType='application/vnd.ms-excel';
      var tableSelect=document.getElementById(tableId)
      var tableHtml=tableSelect.outerHTML.replace(/ /g,'%20');
      //specify file name
      filename=filename?filename+".xls":"excel_data.xls";

      downloadLink=document.createElement('a');

      if(navigator.msSaveOrOpenBlob){
          var blob=new Blob(['\ufeff',tableHtml],{
          type:datatype 
          
          });
          navigator.msSaveOrOpenBlob(blob,filename)

      }else{
          downloadLink.href='data:' + dataType + ',' + tableHtml;
          downloadLink.download=filename
          downloadLink.click()
      }
  }
  
  </script>

   






      




{%endblock content%}